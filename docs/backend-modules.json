{
  "version": "1.1",
  "lastUpdated": "2025-12-03",
  "description": "Backend CMS modules and data models for Devmart Marko v1 - Synchronized with actual database schema",
  "enums": {
    "ContentStatus": {
      "description": "Standard content status across publishable entities",
      "values": ["draft", "published", "archived"],
      "dbType": "content_status"
    },
    "SubmissionStatus": {
      "description": "Status for user-submitted forms (contact, newsletter, etc.)",
      "values": ["new", "read", "responded", "archived"],
      "dbType": "submission_status"
    },
    "BillingPeriod": {
      "description": "Pricing plan billing frequency",
      "values": ["month", "year", "one-time"],
      "dbType": "billing_period"
    },
    "AppRole": {
      "description": "Admin user permission levels",
      "values": ["admin", "editor"],
      "dbType": "app_role"
    }
  },
  "modules": [
    {
      "name": "Services",
      "phase": "v1",
      "tableName": "services",
      "description": "Service offerings displayed on Services page",
      "adminRoute": "/admin/services",
      "publicAccess": "SELECT WHERE status='published'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "name",
          "type": "text",
          "required": true,
          "maxLength": 100,
          "example": "Custom Web Application Development"
        },
        {
          "name": "slug",
          "type": "text",
          "required": true,
          "unique": true,
          "pattern": "^[a-z0-9-]+$",
          "example": "custom-web-apps"
        },
        {
          "name": "description",
          "type": "text",
          "required": true,
          "example": "We build scalable web applications tailored to your business needs..."
        },
        {
          "name": "short_description",
          "type": "text",
          "nullable": true,
          "example": "Tailored web solutions for your business"
        },
        {
          "name": "icon",
          "type": "text",
          "nullable": true,
          "example": "/marko-digital-marketing-agency-html/image/Icon-2.png"
        },
        {
          "name": "featured",
          "type": "boolean",
          "default": false,
          "description": "Display on homepage"
        },
        {
          "name": "sort_order",
          "type": "integer",
          "default": 0,
          "description": "Display order (ascending)"
        },
        {
          "name": "status",
          "type": "enum",
          "enum": "ContentStatus",
          "default": "draft"
        },
        {
          "name": "meta_title",
          "type": "text",
          "nullable": true,
          "example": "Custom Web Apps | Devmart"
        },
        {
          "name": "meta_description",
          "type": "text",
          "nullable": true,
          "example": "Professional custom web application development services"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ]
    },
    {
      "name": "Projects / Case Studies",
      "phase": "v1",
      "tableName": "case_studies",
      "description": "Portfolio projects and case studies",
      "adminRoute": "/admin/projects",
      "publicAccess": "SELECT WHERE status='published'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "title",
          "type": "text",
          "required": true,
          "example": "Government Portal Modernization"
        },
        {
          "name": "slug",
          "type": "text",
          "required": true,
          "unique": true,
          "example": "government-portal-2024"
        },
        {
          "name": "description",
          "type": "text",
          "required": true,
          "example": "Comprehensive modernization of legacy government system..."
        },
        {
          "name": "client_name",
          "type": "text",
          "nullable": true,
          "example": "Tech Solutions Inc."
        },
        {
          "name": "tags",
          "type": "text[]",
          "default": "'{}'::text[]",
          "example": ["Government", "Portal", "Legacy Modernization"]
        },
        {
          "name": "featured_image",
          "type": "text",
          "nullable": true,
          "example": "/uploads/case-studies/project-hero.jpg"
        },
        {
          "name": "results_summary",
          "type": "text",
          "nullable": true,
          "example": "Reduced processing time by 60%, improved citizen satisfaction by 45%"
        },
        {
          "name": "featured",
          "type": "boolean",
          "default": false,
          "description": "Display on homepage"
        },
        {
          "name": "sort_order",
          "type": "integer",
          "default": 0
        },
        {
          "name": "status",
          "type": "enum",
          "enum": "ContentStatus",
          "default": "published"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ]
    },
    {
      "name": "Pricing Plans",
      "phase": "v1",
      "tableName": "pricing_plans",
      "description": "Service packages and pricing tiers",
      "adminRoute": "/admin/pricing",
      "publicAccess": "SELECT WHERE status='published'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "name",
          "type": "text",
          "required": true,
          "example": "Starter"
        },
        {
          "name": "slug",
          "type": "text",
          "required": true,
          "unique": true,
          "example": "starter"
        },
        {
          "name": "description",
          "type": "text",
          "required": true,
          "example": "Perfect for small businesses getting started online"
        },
        {
          "name": "price",
          "type": "numeric",
          "required": true,
          "example": 99.00
        },
        {
          "name": "billing_period",
          "type": "enum",
          "enum": "BillingPeriod",
          "default": "month"
        },
        {
          "name": "features",
          "type": "text[]",
          "default": "'{}'::text[]",
          "example": ["5-page website", "Mobile responsive", "Basic SEO", "Contact form"]
        },
        {
          "name": "target_segment",
          "type": "text",
          "nullable": true,
          "example": "Small businesses & startups"
        },
        {
          "name": "highlighted",
          "type": "boolean",
          "default": false,
          "description": "Show as recommended plan"
        },
        {
          "name": "sort_order",
          "type": "integer",
          "default": 0
        },
        {
          "name": "status",
          "type": "enum",
          "enum": "ContentStatus",
          "default": "published"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ]
    },
    {
      "name": "Testimonials",
      "phase": "v1",
      "tableName": "testimonials",
      "description": "Client reviews and testimonials",
      "adminRoute": "/admin/testimonials",
      "publicAccess": "SELECT WHERE status='published'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "author_name",
          "type": "text",
          "required": true,
          "example": "Sarah Johnson"
        },
        {
          "name": "company_name",
          "type": "text",
          "nullable": true,
          "example": "Tech Innovations Ltd."
        },
        {
          "name": "author_title",
          "type": "text",
          "nullable": true,
          "example": "CEO"
        },
        {
          "name": "quote",
          "type": "text",
          "required": true,
          "example": "Devmart delivered exceptional results. Their technical expertise and professionalism exceeded our expectations."
        },
        {
          "name": "rating",
          "type": "integer",
          "nullable": true,
          "min": 1,
          "max": 5,
          "example": 5
        },
        {
          "name": "avatar_url",
          "type": "text",
          "nullable": true,
          "example": "/uploads/testimonials/client-photo.jpg"
        },
        {
          "name": "featured",
          "type": "boolean",
          "default": false,
          "description": "Display on homepage"
        },
        {
          "name": "sort_order",
          "type": "integer",
          "default": 0
        },
        {
          "name": "status",
          "type": "enum",
          "enum": "ContentStatus",
          "default": "published"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ]
    },
    {
      "name": "Blog Posts",
      "phase": "v1",
      "tableName": "blog_posts",
      "description": "Blog articles and content marketing",
      "adminRoute": "/admin/blog",
      "publicAccess": "SELECT WHERE status='published'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "title",
          "type": "text",
          "required": true,
          "example": "10 Web Development Trends for 2025"
        },
        {
          "name": "slug",
          "type": "text",
          "required": true,
          "unique": true,
          "example": "web-development-trends-2025"
        },
        {
          "name": "excerpt",
          "type": "text",
          "nullable": true,
          "example": "Discover the latest trends shaping the future of web development..."
        },
        {
          "name": "content",
          "type": "text",
          "required": true,
          "description": "Full article content (HTML or Markdown)"
        },
        {
          "name": "category",
          "type": "text",
          "required": true,
          "example": "Web Development"
        },
        {
          "name": "tags",
          "type": "text[]",
          "nullable": true,
          "example": ["JavaScript", "React", "Web Design"]
        },
        {
          "name": "featured_image",
          "type": "text",
          "nullable": true,
          "example": "/uploads/blog/post-hero.jpg"
        },
        {
          "name": "author_id",
          "type": "uuid",
          "foreignKey": "admin_users.id",
          "nullable": true
        },
        {
          "name": "meta_title",
          "type": "text",
          "nullable": true,
          "example": "Web Development Trends 2025 | Devmart Blog"
        },
        {
          "name": "meta_description",
          "type": "text",
          "nullable": true,
          "example": "Explore the top web development trends for 2025"
        },
        {
          "name": "status",
          "type": "enum",
          "enum": "ContentStatus",
          "default": "draft"
        },
        {
          "name": "published_at",
          "type": "timestamp with time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ],
      "relationships": [
        {
          "type": "many-to-one",
          "target": "admin_users",
          "foreignKey": "author_id",
          "description": "Blog post author"
        }
      ]
    },
    {
      "name": "Team Members",
      "phase": "v1",
      "tableName": "team_members",
      "description": "Company team member profiles",
      "adminRoute": "/admin/team",
      "publicAccess": "SELECT WHERE status='active'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "full_name",
          "type": "text",
          "required": true,
          "example": "Alex Martinez"
        },
        {
          "name": "role",
          "type": "text",
          "required": true,
          "example": "Lead Developer"
        },
        {
          "name": "title",
          "type": "text",
          "nullable": true,
          "example": "Senior Software Engineer"
        },
        {
          "name": "short_bio",
          "type": "text",
          "nullable": true,
          "example": "10+ years of experience building scalable web applications..."
        },
        {
          "name": "photo_url",
          "type": "text",
          "nullable": true,
          "example": "/uploads/team/alex-martinez.jpg"
        },
        {
          "name": "email",
          "type": "text",
          "nullable": true,
          "format": "email",
          "example": "alex@devmart.sr"
        },
        {
          "name": "linkedin_url",
          "type": "text",
          "nullable": true,
          "example": "https://linkedin.com/in/alexmartinez"
        },
        {
          "name": "facebook_url",
          "type": "text",
          "nullable": true,
          "example": "https://facebook.com/alexmartinez"
        },
        {
          "name": "instagram_url",
          "type": "text",
          "nullable": true,
          "example": "https://instagram.com/alexmartinez"
        },
        {
          "name": "sort_order",
          "type": "integer",
          "default": 0
        },
        {
          "name": "is_featured",
          "type": "boolean",
          "default": false,
          "description": "Highlight on homepage"
        },
        {
          "name": "status",
          "type": "text",
          "default": "'active'",
          "description": "Values: active, inactive"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ]
    },
    {
      "name": "FAQ Items",
      "phase": "v1",
      "tableName": "faq_items",
      "description": "Frequently asked questions",
      "adminRoute": "/admin/faqs",
      "publicAccess": "SELECT WHERE status='active'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "question",
          "type": "text",
          "required": true,
          "example": "How long does it take to build a custom web application?"
        },
        {
          "name": "answer",
          "type": "text",
          "required": true,
          "example": "Development timelines vary based on project complexity. A typical web application takes 8-12 weeks..."
        },
        {
          "name": "category",
          "type": "text",
          "nullable": true,
          "example": "Development Process"
        },
        {
          "name": "sort_order",
          "type": "integer",
          "default": 0
        },
        {
          "name": "is_featured",
          "type": "boolean",
          "default": false,
          "description": "Show on homepage FAQ section"
        },
        {
          "name": "status",
          "type": "text",
          "default": "'active'",
          "description": "Values: active, inactive"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ]
    },
    {
      "name": "Contact Submissions",
      "phase": "v1",
      "tableName": "contact_submissions",
      "description": "Contact form submissions inbox",
      "adminRoute": "/admin/contacts",
      "publicAccess": "INSERT only (anonymous)",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "first_name",
          "type": "text",
          "required": true,
          "example": "John"
        },
        {
          "name": "last_name",
          "type": "text",
          "required": true,
          "example": "Doe"
        },
        {
          "name": "email",
          "type": "text",
          "required": true,
          "format": "email",
          "example": "john.doe@example.com"
        },
        {
          "name": "phone",
          "type": "text",
          "nullable": true,
          "example": "+597 123-4567"
        },
        {
          "name": "company",
          "type": "text",
          "nullable": true,
          "example": "Acme Corp"
        },
        {
          "name": "subject",
          "type": "text",
          "required": true,
          "example": "Project Inquiry - E-commerce Website"
        },
        {
          "name": "message",
          "type": "text",
          "required": true,
          "example": "I'm interested in building an e-commerce platform for my business..."
        },
        {
          "name": "status",
          "type": "enum",
          "enum": "SubmissionStatus",
          "default": "new"
        },
        {
          "name": "notes",
          "type": "text",
          "nullable": true,
          "description": "Internal admin notes for tracking"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()",
          "description": "Submission date"
        },
        {
          "name": "responded_at",
          "type": "timestamp with time zone",
          "nullable": true,
          "description": "When admin marked as responded"
        }
      ]
    },
    {
      "name": "Site Settings",
      "phase": "v1",
      "tableName": "site_settings",
      "description": "Global site configuration (contact info, branding, SEO)",
      "adminRoute": "/admin/settings",
      "publicAccess": "SELECT (all keys)",
      "fields": [
        {
          "name": "key",
          "type": "text",
          "primaryKey": true,
          "example": "site_name"
        },
        {
          "name": "value",
          "type": "text",
          "required": true,
          "example": "Devmart Suriname"
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true,
          "example": "Brand name displayed in header and footer"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ],
      "predefinedSettings": [
        { "key": "site_name", "value": "Devmart Suriname", "category": "brand" },
        { "key": "tagline", "value": "Digital Solutions for Your Business", "category": "brand" },
        { "key": "copyright_text", "value": "Â© 2025 Devmart Suriname. All Rights Reserved.", "category": "brand" },
        { "key": "contact_email", "value": "info@devmart.sr", "category": "contact" },
        { "key": "contact_phone", "value": "+597 854-1211", "category": "contact" },
        { "key": "contact_address", "value": "Jagernath Lachmon straat nr. 152, Paramaribo, Suriname", "category": "contact" },
        { "key": "facebook_url", "value": "https://www.facebook.com/DevmartSuriname/", "category": "social" },
        { "key": "linkedin_url", "value": "", "category": "social" },
        { "key": "instagram_url", "value": "", "category": "social" },
        { "key": "twitter_url", "value": "", "category": "social" },
        { "key": "github_url", "value": "", "category": "social" },
        { "key": "seo_default_title", "value": "Devmart - Web Development & Digital Solutions", "category": "seo" },
        { "key": "seo_default_description", "value": "Professional web development and digital solutions in Suriname", "category": "seo" },
        { "key": "primary_color", "value": "#4be89b", "category": "branding" },
        { "key": "accent_color", "value": "#4be89b", "category": "branding" }
      ]
    },
    {
      "name": "Admin Users",
      "phase": "v1",
      "tableName": "admin_users",
      "description": "CMS admin user profiles (linked to Supabase Auth)",
      "adminRoute": "/admin/users",
      "publicAccess": "None",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "description": "Linked to Supabase Auth user ID"
        },
        {
          "name": "email",
          "type": "text",
          "required": true,
          "unique": true,
          "format": "email",
          "example": "admin@devmart.sr"
        },
        {
          "name": "full_name",
          "type": "text",
          "required": true,
          "example": "Admin User"
        },
        {
          "name": "last_login",
          "type": "timestamp with time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ],
      "note": "Roles are NOT stored in this table. See user_roles table for role assignments."
    },
    {
      "name": "User Roles",
      "phase": "v1",
      "tableName": "user_roles",
      "description": "Role assignments for admin users (separate table for security)",
      "adminRoute": "/admin/users",
      "publicAccess": "None",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "user_id",
          "type": "uuid",
          "required": true,
          "description": "References auth.users.id"
        },
        {
          "name": "role",
          "type": "enum",
          "enum": "AppRole",
          "required": true,
          "description": "admin or editor"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ],
      "constraints": [
        {
          "type": "unique",
          "columns": ["user_id", "role"],
          "description": "Each user can only have one entry per role"
        }
      ],
      "securityNote": "Roles MUST be stored in this separate table, NOT in admin_users or profiles. This prevents privilege escalation attacks via direct profile updates."
    },
    {
      "name": "Partner Logos",
      "phase": "v2-implemented",
      "tableName": "partner_logos",
      "description": "Partner/client logo carousel for marketing site",
      "adminRoute": "/admin/partners",
      "publicAccess": "SELECT WHERE status='active'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "name",
          "type": "text",
          "required": true,
          "example": "Acme Corporation"
        },
        {
          "name": "logo_url",
          "type": "text",
          "required": true,
          "example": "/uploads/partners/acme-logo.png"
        },
        {
          "name": "website_url",
          "type": "text",
          "nullable": true,
          "example": "https://acme.com"
        },
        {
          "name": "sort_order",
          "type": "integer",
          "default": 1
        },
        {
          "name": "status",
          "type": "text",
          "default": "'active'",
          "description": "active or inactive"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ]
    },
    {
      "name": "Newsletter Subscribers",
      "phase": "v2-implemented",
      "tableName": "newsletter_subscribers",
      "description": "Email subscription list for newsletter",
      "adminRoute": "/admin/newsletter",
      "publicAccess": "INSERT only (public subscription)",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "email",
          "type": "text",
          "required": true,
          "unique": true,
          "example": "user@example.com"
        },
        {
          "name": "status",
          "type": "text",
          "default": "'subscribed'",
          "description": "subscribed or unsubscribed"
        },
        {
          "name": "subscribed_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "unsubscribed_at",
          "type": "timestamp with time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ]
    },
    {
      "name": "Homepage Content Blocks",
      "phase": "v2-implemented",
      "tableName": "homepage_blocks",
      "description": "Dynamic content blocks for homepage (backend only - not yet wired to frontend)",
      "adminRoute": "/admin/homepage",
      "publicAccess": "SELECT WHERE status='active'",
      "fields": [
        {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "key",
          "type": "text",
          "required": true,
          "unique": true,
          "example": "hero"
        },
        {
          "name": "block_type",
          "type": "text",
          "required": true,
          "description": "hero, text-and-image, stat-grid, cta, features, custom"
        },
        {
          "name": "title",
          "type": "text",
          "nullable": true
        },
        {
          "name": "subtitle",
          "type": "text",
          "nullable": true
        },
        {
          "name": "content",
          "type": "text",
          "nullable": true
        },
        {
          "name": "image_url",
          "type": "text",
          "nullable": true
        },
        {
          "name": "button_label",
          "type": "text",
          "nullable": true
        },
        {
          "name": "button_url",
          "type": "text",
          "nullable": true
        },
        {
          "name": "sort_order",
          "type": "integer",
          "default": 1
        },
        {
          "name": "status",
          "type": "text",
          "default": "'active'",
          "description": "active or inactive"
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "default": "now()"
        }
      ],
      "note": "Backend + admin UI complete. Frontend wiring deferred to Phase C."
    }
  ],
  "databaseFunctions": [
    {
      "name": "has_role",
      "description": "Check if a user has a specific role",
      "parameters": ["_user_id uuid", "_role app_role"],
      "returns": "boolean",
      "security": "SECURITY DEFINER",
      "usage": "Used in RLS policies for authorization checks"
    },
    {
      "name": "update_updated_at_column",
      "description": "Trigger function to auto-update updated_at timestamp",
      "returns": "trigger",
      "security": "SECURITY DEFINER"
    }
  ]
}
